name: ğŸš€ Auto Update & Deploy Ferrik Bot

on:
  workflow_dispatch:  # Ğ´Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑÑ” Ğ·Ğ°Ğ¿ÑƒÑĞº Ğ²Ñ€ÑƒÑ‡Ğ½Ñƒ
  schedule:
    - cron: '0 9 * * *'  # Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ¾ Ñ‰Ğ¾Ğ´Ğ½Ñ Ğ¾ 9:00 (UTC)

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ§© Checkout latest version
        uses: actions/checkout@v4

      - name: ğŸ” Check for updates
        run: |
          git fetch origin main
          if git diff --quiet HEAD origin/main; then
            echo "âœ… Repo already up to date â€” no new commits"
            exit 0
          else
            echo "ğŸ†• New commits found â€” proceeding to deploy"
          fi

      - name: ğŸš€ Trigger Render deploy
        run: |
          curl -X POST \
            -H "Accept: application/json" \
            -H "Authorization: Bearer ${{ secrets.RENDER_API_KEY }}" \
            -d '{"serviceId": "${{ secrets.RENDER_SERVICE_ID }}"}' \
            https://api.render.com/v1/services/${{ secrets.RENDER_SERVICE_ID }}/deploys
