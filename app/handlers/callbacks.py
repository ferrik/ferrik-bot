"""
üîß –î–û–î–ê–ô –¶–ï–ô –ö–û–î –í –°–ê–ú–ò–ô –ü–û–ß–ê–¢–û–ö –§–ê–ô–õ–£ app/handlers/callbacks.py
(–ø—ñ—Å–ª—è —ñ–º–ø–æ—Ä—Ç—ñ–≤, –ø–µ—Ä–µ–¥ –±—É–¥—å-—è–∫–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏)
"""

import logging

logger = logging.getLogger(__name__)


# ============================================================================
# HELPER FUNCTION - –ë–µ–∑–ø–µ—á–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ callback query
# ============================================================================

async def safe_answer_query(query, text: str, show_alert: bool = False):
    """
    –ë–µ–∑–ø–µ—á–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ callback query –∑ –æ–±—Ä–æ–±–∫–æ—é timeout —Ç–∞ —ñ–Ω—à–∏—Ö –ø–æ–º–∏–ª–æ–∫
    
    Args:
        query: CallbackQuery object
        text: –¢–µ–∫—Å—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
        show_alert: –ü–æ–∫–∞–∑—É–≤–∞—Ç–∏ —è–∫ alert (True) –∞–±–æ toast (False)
    """
    try:
        await query.answer(text, show_alert=show_alert)
    except Exception as e:
        # –õ–æ–≥—É—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è, –∞–ª–µ –Ω–µ –∫–∏–¥–∞—î–º–æ exception
        logger.warning(f"‚ö†Ô∏è Failed to answer callback query: {e}")
        # –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞ - –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –ø—Ä–æ—Å—Ç–æ –Ω–µ –ø–æ–±–∞—á–∏—Ç–∏ toast


# ============================================================================
# –ü–û–¢–Ü–ú –ó–ù–ê–ô–î–ò –í–°–Ü –ú–Ü–°–¶–Ø –ó query.answer() –¢–ê –ó–ê–ú–Ü–ù–ò–¢–ò –ù–ê safe_answer_query()
# ============================================================================

# –ü–†–ò–ö–õ–ê–î –ó–ê–ú–Ü–ù–ò:
#
# –ë—É–ª–æ:
# await query.answer("‚úÖ –ì–æ—Ç–æ–≤–æ!")
#
# –°—Ç–∞–ª–æ:
# await safe_answer_query(query, "‚úÖ –ì–æ—Ç–æ–≤–æ!")
#
# ----
#
# –ë—É–ª–æ:
# await query.answer("‚ùå –ü–æ–º–∏–ª–∫–∞!", show_alert=True)
#
# –°—Ç–∞–ª–æ:
# await safe_answer_query(query, "‚ùå –ü–æ–º–∏–ª–∫–∞!", show_alert=True)